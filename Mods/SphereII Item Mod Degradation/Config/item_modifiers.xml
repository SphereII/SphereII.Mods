<configs>

    <include filename="ItemModifiers/General.xml"/>

    <!-- Water Purifier -->
    <append xpath="//item_modifier[@name='modArmorWaterPurifier']">
        <effect_group name="Damage During Use Override">
            <requirement name="ItemPercentUsed, SCore" operation="LT" value="1"/>
            <requirement name="IsEquipped" />
            
            <!-- Player hand -->
            <triggered_effect trigger="onSelfAction2End" action="DegradeItemValueMod, SCore"/>

            <!-- Murky water -->
            <triggered_effect trigger="onSelfPrimaryActionEnd" action="DegradeItemValueMod, SCore"/>
        </effect_group>
        
        <effect_group name="Item Broken Override">
            <requirement name="ItemPercentUsed, SCore" operation="GTE" value="1"/>
            <requirement name="IsEquipped" />
            <triggered_effect trigger="onSelfAction2End" action="AddBuff" buff="buffStatusModBroken"/>
            <triggered_effect trigger="onSelfPrimaryActionEnd" action="AddBuff" buff="buffStatusModBroken"/>
        </effect_group>
    </append>


    <!-- Helmet Light  -->
    <append xpath="//item_modifier[@name='modArmorHelmetLight']/effect_group[@name='BrokenHooks']">
        <triggered_effect trigger="onSelfRoutineUpdate" action="SetPartActive" part="HeadLight" active="false" />
    </append>
    
    <append xpath="//item_modifier[@name='modArmorHelmetLight']">
        <effect_group name="Item Broken Helmet Light">
            <requirement name="ItemPercentUsed, SCore" operation="GTE" value="1"/>
            <requirement name="IsEquipped" />
            <triggered_effect trigger="onSelfItemActivate" action="SetPartActive" part="HeadLight" active="false" />
        </effect_group>
    </append>
    <!--
    <append xpath="//item_modifier[@name='modArmorHelmetLight']/effect_group/triggered_effect[@trigger='onSelfItemActivate']">
        <requirement name="ItemPercentUsed, SCore" operation="LT" value="1"/>
    </append>
    -->

</configs>